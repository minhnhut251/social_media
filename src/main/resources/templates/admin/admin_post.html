<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <title>Quản Lý Bài Đăng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <script type="text/javascript" src="/webjars/jquery/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <style>
        body { background-color: #ffffff; color: #000000; }
        .sidebar { width: 250px; height: 100vh; position: fixed; left: 0; top: 0; padding: 60px 20px; background: #f8f9fa; }
        .au { margin-left: 270px; padding: 60px 20px; }
        .sidebar a { color: #000000; text-decoration: none; display: block; padding: 10px; border-radius: 5px; }
        .sidebar a:hover { background: #e2e6ea; color: #007bff; }

        .btn-custom { background: #007bff; color: white; border: none; }
        .btn-custom:hover { background: #0056b3; }

        .status-pending { background-color: #fff3cd; color: #856404; padding: 5px 10px; border-radius: 4px; }
        .status-active { background-color: #d4edda; color: #155724; padding: 5px 10px; border-radius: 4px; }
        .status-suspended { background-color: #f8d7da; color: #721c24; padding: 5px 10px; border-radius: 4px; }

        .user-image, .banner-image {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 8px;
        }
        .media-image, .media-video {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
       }

        .table th, .table td {
            vertical-align: middle !important;
            text-align: center;
         }


        .action-buttons { display: flex; gap: 5px; }
    </style>
</head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<div th:replace="~{fragments/sidebar_admin :: sidebar_admin}"></div>

<div class="content au">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h4">Quản Lý Bài Đăng</h1>
<!--        <div style="max-width: 200px;">-->
<!--            <select id="statusFilter" class="form-select">-->
<!--                <option value="">Tất cả trạng thái</option>-->
<!--                <option value="PENDING_APPROVAL">Chờ duyệt</option>-->
<!--                <option value="ACTIVE">Đang hoạt động</option>-->
<!--                <option value="SUSPENDED">Đã tạm ngưng</option>-->
<!--            </select>-->
<!--        </div>-->
    </div>

    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover align-middle text-center">
                    <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Nội dung</th>
                        <th>Loại</th>
                        <th>Media</th>
                        <th>Người đăng</th>
                        <th>Sản phẩm liên kết</th>
                        <th>Ngày tạo</th>
                        <th>Ngày cập nhật</th>
                        <th>Hành động</th>
                    </tr>
                    </thead>
                    <tbody id="postsTable">
                    <tr th:each="post : ${posts}">
                        <td th:text="${post.mabd}">1</td>
                        <td th:text="${post.noiDung}">Nội dung</td>
                        <td th:text="${post.loaiBaiDang}">IMAGE</td>
                        <td style="min-width: 100px;">
                            <div class="d-flex justify-content-center align-items-center">
                                <!-- Display Image if type is IMAGE -->
                                <img th:if="${post.loaiBaiDang == 'IMAGE'}"
                                     th:src="@{${post.mediaURL}}"
                                     alt="Ảnh"
                                     class="media-image" />

                                <!-- Display Video if type is VIDEO -->
                                <video th:if="${post.loaiBaiDang == 'VIDEO'}"
                                       controls
                                       class="media-video">
                                    <source th:src="@{${post.mediaURL}}" type="video/mp4">
                                    Trình duyệt không hỗ trợ video.
                                </video>

                                <!-- Display placeholder if type is TEXT -->
                                <span th:if="${post.loaiBaiDang == 'TEXT'}" class="text-muted">-</span>
                            </div>
                        </td>


                        <td th:text="${post.users.email}">user@example.com</td>
                        <td th:text="${post.sanPham != null ? post.sanPham.tensp : 'Không có'}">Sản phẩm A</td>
                        <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                        <td th:text="${#temporals.format(post.updatedAt, 'yyyy-MM-dd HH:mm')}"></td>
                        <td>
                            <div class="action-buttons">
<!--                                <a th:href="@{'/admin/posts/edit/' + ${post.mabd}}" class="btn btn-sm btn-primary">-->
<!--                                    <i class="fas fa-edit"></i>-->
<!--                                </a>-->
                                <a th:href="@{'/admin/posts/delete/' + ${post.mabd}}" class="btn btn-sm btn-danger" onclick="return confirm('Xoá bài đăng này?')">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(posts)}">
                        <td colspan="8" class="text-center text-muted">Không có bài đăng nào</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
